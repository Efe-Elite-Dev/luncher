name: Project-SEKA Auto Build

on:
  push:
    branches: [ main ]  # Kod her main'e gittiÄŸinde Ã§alÄ±ÅŸÄ±r

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ KodlarÄ± Ã‡ek
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ”¢ Versiyonu Otomatik DeÄŸiÅŸtir
        run: |
          # Mevcut versiyonu oku, son rakamÄ± artÄ±r
          if [ ! -f version.txt ]; then echo "1.8.0" > version.txt; fi
          VERSION=$(cat version.txt)
          NEW_V=$(echo $VERSION | awk -F. '{$NF = $NF + 1;} 1' OFS=.)
          echo $NEW_V > version.txt
          echo "NEW_VERSION=$NEW_V" >> $GITHUB_ENV
          echo "Yeni SÃ¼rÃ¼m: $NEW_V"

      - name: ğŸ› ï¸ Android SDK Kurulumu
        uses: actions/setup-java@v4
        with:
          distribution: 'zulu'
          java-version: '17'

      - name: ğŸ—ï¸ SekaLauncher Derle (Midnight Glow Logic)
        run: |
          # Burada Gradle komutu Ã§alÄ±ÅŸÄ±r (SÄ±fÄ±rdan yaptÄ±ÄŸÄ±mÄ±z Launcher iÃ§in)
          chmod +x gradlew
          ./gradlew assembleDebug

      - name: ğŸµ Vega.ogg KontrolÃ¼
        run: |
          if [ -f "Vega.ogg" ]; then
            echo "Vega.ogg bulundu, pakete ekleniyor."
          else
            echo "Vega.ogg bulunamadÄ±, bu adÄ±m atlanÄ±yor."
          fi

      - name: ğŸ“¤ Build DosyalarÄ±nÄ± Kaydet (Artifacts)
        uses: actions/upload-artifact@v4
        with:
          name: PJSK-OS-v${{ env.NEW_VERSION }}
          path: |
            app/build/outputs/apk/debug/*.apk
            version.txt
            Vega.ogg

      - name: ğŸ“¡ ADB Status Note
        run: echo "ADB Status: Always Open Mode Active in Build"
