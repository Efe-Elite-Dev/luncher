name: Project-SEKA Auto Build

on:
  push:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ KodlarÄ± Ã‡ek
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ”¢ Versiyonu Otomatik DeÄŸiÅŸtir
        run: |
          if [ ! -f version.txt ]; then echo "1.8.0" > version.txt; fi
          VERSION=$(cat version.txt)
          NEW_V=$(echo $VERSION | awk -F. '{$NF = $NF + 1;} 1' OFS=.)
          echo $NEW_V > version.txt
          echo "NEW_VERSION=$NEW_V" >> $GITHUB_ENV
          echo "Build sÃ¼rÃ¼mÃ¼: $NEW_V"

      - name: ğŸ› ï¸ Java Kurulumu
        uses: actions/setup-java@v4
        with:
          distribution: 'zulu'
          java-version: '17'

      - name: ğŸ—ï¸ SekaLauncher Derle
        run: |
          if [ -f gradlew ]; then
            chmod +x gradlew
            ./gradlew assembleDebug
          else
            echo "Gradlew bulunamadÄ±, APK adÄ±mÄ± atlanÄ±yor."
          fi

      - name: ğŸµ Vega.ogg KontrolÃ¼
        run: |
          if [ -f "Vega.ogg" ]; then
            echo "Vega.ogg mevcut."
          else
            touch Vega.ogg # Dosya yoksa hata vermemesi iÃ§in boÅŸ bir tane oluÅŸturur
          fi

      - name: ğŸ“¤ DosyalarÄ± Kaydet (Artifacts)
        uses: actions/upload-artifact@v4
        with:
          name: PJSK-OS-Build
          path: |
            version.txt
            Vega.ogg
